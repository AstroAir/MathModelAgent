# 最佳实践指南

> **文档版本**: v2.0  
> **最后更新**: 2025-01-17  
> **预计阅读时间**: 15 分钟

本指南提供了一系列使用 MathModelAgent 的最佳实践和高级技巧，帮助您在数学建模竞赛中获得更好的结果、提升效率并优化成本。

## 📋 目录

-   [问题描述技巧](#-问题描述技巧)
-   [数据准备策略](#-数据准备策略)
-   [模型选择与配置](#-模型选择与配置)
-   [工作流优化](#-工作流优化)
-   [成本控制](#-成本控制)
-   [结果验证与迭代](#-结果验证与迭代)

## 📝 问题描述技巧

高质量的输入是高质量输出的关键。一个好的问题描述能显著提升 Agent 的表现。

### 1. 结构化您的问题

不要只粘贴原始赛题，尝试用结构化的方式重新组织问题。

**推荐结构**:

```markdown
**1. 问题背景**
[简要介绍问题的现实背景和目标。]

**2. 已知数据与信息**
-   数据来源：[文件 A.csv, B.xlsx]
-   关键参数：[例如，生产成本、时间限制等]
-   约束条件：[例如，资源总量、物理定律等]

**3. 待解决的问题**
-   **问题一**: [清晰、具体地描述第一个要解决的问题，例如：建立一个预测模型...]
-   **问题二**: [例如：求解最优生产策略...]
-   **问题三**: [例如：对模型的灵敏度进行分析...]

**4. 期望的输出**
-   [可选] 您希望模型输出什么？（例如：一个具体的数值、一个图表、一个决策建议）
-   [可选] 有没有偏好的模型或方法？（例如：请优先考虑使用线性规划）
```

### 2. 使用清晰、无歧义的语言

-   **避免口语化**: 使用书面语言。
-   **定义术语**: 如果有专业术语，请稍作解释。
-   **量化指标**: 尽量使用具体数字，而不是“很多”、“很高”等模糊词汇。

### 3. 利用 Prompt 优化功能

在提交任务前，可以先使用 **"Prompt 优化"** 功能，让 AI 帮助您改进问题描述。

## 📊 数据准备策略

数据的质量直接影响建模结果。

### 1. 清洁和预处理数据

-   **处理缺失值**: 在上传前，考虑填充或删除缺失值。
-   **统一格式**: 确保同一列的数据格式一致（例如，日期格式统一为 `YYYY-MM-DD`）。
-   **明确列名**: 使用清晰、有描述性的列名（推荐使用英文）。

### 2. 合理组织文件

-   **文件夹上传**: 如果数据文件较多，使用文件夹上传并保持其目录结构。
-   **压缩包**: 对于非常大的数据集，先压缩再上传可以节省时间。
-   **README 文件**: 在数据文件中包含一个 `README.md` 或 `说明.txt`，解释每个文件的内容和字段含义，这将极大地帮助 Agent 理解数据。

**示例 `README.md`**:
```markdown
# 数据说明

-   `sales.csv`: 2023 年产品销售记录
    -   `date`: 销售日期
    -   `product_id`: 产品 ID
    -   `quantity`: 销售数量
-   `products.csv`: 产品信息
    -   `id`: 产品 ID
    -   `name`: 产品名称
    -   `cost`: 生产成本
```

## 🤖 模型选择与配置

合理的模型配置是平衡成本和性能的关键。

-   **混合搭配**: 为不同 Agent 选择不同模型是最高效的方式。请参考[模型配置指南](model-configuration.md)。
-   **从弱到强**: 如果不确定问题难度，可以先用较弱（便宜）的模型（如 `gpt-3.5-turbo`）进行初步尝试。如果结果不理想，再切换到更强的模型（如 `gpt-4-turbo`）重新运行。
-   **专用模型**: 充分利用代码专用模型（如 `deepseek/deepseek-coder`）来处理 `CoderAgent` 的任务，通常性价比更高。

## ⚙️ 工作流优化

### 1. 分解复杂问题

对于包含多个独立子问题的复杂赛题，可以将其分解成多个独立的 MathModelAgent 任务来处理。

**优势**:
-   **隔离失败**: 一个子任务的失败不会影响其他任务。
-   **专注性**: 每个任务的 Agent 可以更专注于一个特定问题。
-   **结果复用**: 前一个任务的结果（如数据预处理代码、结论）可以作为下一个任务的输入。

### 2. 迭代式建模

不要期望一次就得到完美结果。建模是一个迭代的过程。

1.  **运行初版**: 快速运行一个版本，获取初步结果。
2.  **分析结果**: 检查生成的代码和论文，找出不足之处。
3.  **手动干预**: 下载并修改 `.ipynb` 文件，手动优化代码或添加新的分析。
4.  **二次生成**: 将手动优化的结果作为新的输入，或通过修改提示词让 WriterAgent 重新生成论文的特定部分。

## 💰 成本控制

-   **监控 Token 使用**: 在任务详情页的 **"统计"** 标签页，可以查看每个 Agent 的 Token 消耗和费用。
-   **使用低成本模型**: 在探索阶段或处理简单问题时，优先使用低成本模型。
-   **精简问题描述**: 去除不必要的背景信息，只保留核心问题和数据描述。
-   **限制对话轮次**: 如果发现某个 Agent 陷入循环，可以考虑在 `backend/.env.dev` 中降低 `MAX_CHAT_TURNS` 的值。

## ✅ 结果验证与迭代

AI 生成的结果需要经过您的审查和验证。

### 1. 检查代码

-   **逻辑审查**: 仔细阅读 `.ipynb` 文件，检查代码逻辑是否符合您的预期和模型设计。
-   **复现结果**: 尝试在本地环境中重新运行 Notebook，确保结果可以复现。
-   **参数敏感性**: 修改代码中的关键参数，观察结果的变化，测试模型的鲁棒性。

### 2. 审查论文

-   **事实核查**: 检查论文中的数据、结论是否与代码执行结果一致。
-   **语言润色**: AI 生成的语言可能较为生硬，需要您进行人工润色，使其更符合学术规范。
-   **图表检查**: 确认图表的标题、坐标轴、图例是否清晰、准确。
-   **文献引用**: 检查 `WriterAgent` 自动引用的文献是否相关和准确。

### 3. 利用历史任务

-   **收藏经典案例**: 将成功的任务收藏起来，作为未来解决类似问题的模板。
-   **比较不同策略**: 对同一个问题，尝试使用不同的模型配置或问题描述，然后比较历史任务的结果，总结出最佳实践。

## 📚 相关文档

-   [模型配置指南](model-configuration.md)
-   [自定义提示词](custom-prompts.md)
-   [任务管理指南](task-management.md)

---

**上一页**: [任务管理指南](task-management.md)  
**文档首页**: [../README.md](../README.md)
